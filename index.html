<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="TrajFlow: Multi-modal Motion Prediction via Flow Matching">
  <meta name="keywords" content="Trajectory Prediction, Motion Prediction, Flow Matching">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>TrajFlow: Multi-modal Motion Prediction via Flow Matching</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.png">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <!-- <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://dsl-lab.github.io/">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>
    </div>
  </div> -->
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">TrajFlow: Multi-modal Motion Prediction via Flow Matching</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://qiyan98.github.io/">Qi Yan</a><sup>1,2</sup>,</span>
            <span class="author-block">
              <a href="https://www.linkedin.com/in/brianzhg/">Brian Zhang</a><sup>3</sup>,</span>
            <span class="author-block">
              <a href="https://www.isye.gatech.edu/users/yutong-zhang">Yutong Zhang</a><sup>4</sup>,
            </span>
            <span class="author-block">
              <a href="https://www.ri.cmu.edu/ri-people/hsueh-han-yang/">Daniel Yang</a><sup>5</sup>,
            </span>
            <span class="author-block">
              <a href="https://www.linkedin.com/in/joshua-white-16a03b186/">Joshua White</a><sup>6</sup>,
            </span>
            <span class="author-block">
              <a href="https://www.linkedin.com/in/di-chen-46747ab2/">Di Chen</a><sup>7</sup>,
            </span>
            <span class="author-block">
              <a href="https://www.linkedin.com/in/jiachao-liu-ba9b3127b/">Jiachao Liu</a><sup>8</sup>
            </span>
            <span class="author-block">
              <a href="http://linkedin.com/in/patrick-llgc/">Langechuan Liu</a><sup>9</sup>
            </span>
            <span class="author-block">
              <a href="https://www.linkedin.com/in/binnan-zhuang-24348419/">Binnan Zhuang</a><sup>9</sup>
            </span>
            <span class="author-block">
              <a href="https://shishaoshuai.com/">Shaoshuai Shi</a><sup>10</sup>
            </span>
            <span class="author-block">
              <a href="https://lrjconan.github.io/">Renjie Liao</a><sup>1,2,11</sup>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>University of British Columbia,</span>
            <span class="author-block"><sup>2</sup>Vector Institute for AI,</span>
            <span class="author-block"><sup>3</sup>University of Waterloo,</span>
            <span class="author-block"><sup>4</sup>Georgia Institute of Technology,</span>
            <span class="author-block"><sup>5</sup>Carnegie Mellon University,</span>
            <span class="author-block"><sup>6</sup>Tesla,</span>
            <span class="author-block"><sup>7</sup>XPeng Motors,</span>
            <span class="author-block"><sup>8</sup>Leapmotor,</span>
            <span class="author-block"><sup>9</sup>Nvidia,</span>
            <span class="author-block"><sup>10</sup>DiDi,</span>
            <span class="author-block"><sup>11</sup>Canada CIFAR AI Chair.</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <span class="link-block">
                <a href="https://www.arxiv.org/abs/2506.08541"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/qiyan98/TrajFlow"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

    <!-- Visualizations -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Visualizations</h2>
      </div>
    </div>

    <div class="container" style="max-width: 1200px;">
      <div class="columns is-centered" style="margin: 0 -0.25rem;">
        <div class="column is-half" style="padding: 0 0.25rem;">
          <div class="content has-text-centered" style="margin: 0;">
            <img src="./static/images/vehicle_1.gif" loading="lazy" onerror="this.onerror=null"  alt="Vehicle prediction example" class="image" style="max-width: 100%; margin: 0 auto;">
            <p class="is-size-6" style="margin-top: 0.5rem;">Vehicle agent</p>
          </div>
        </div>
        <div class="column is-half" style="padding: 0 0.25rem;">
          <div class="content has-text-centered" style="margin: 0;">
            <img src="./static/images/vehicle_2.gif" loading="lazy" onerror="this.onerror=null"  alt="Vehicle prediction example" class="image" style="max-width: 100%; margin: 0 auto;">
            <p class="is-size-6" style="margin-top: 0.5rem;">Vehicle agent</p>
          </div>
        </div>
      </div>

      <div class="columns is-centered" style="margin: 2rem -0.25rem 0 -0.25rem;">
        <div class="column is-half" style="padding: 0 0.25rem;">
          <div class="content has-text-centered" style="margin: 0;">
            <img src="./static/images/cyclist.gif" loading="lazy" onerror="this.onerror=null"  alt="Cyclist prediction example" class="image" style="max-width: 100%; margin: 0 auto;">
            <p class="is-size-6" style="margin-top: 0.5rem;">Cyclist agent</p>
          </div>
        </div>
        <div class="column is-half" style="padding: 0 0.25rem;">
          <div class="content has-text-centered" style="margin: 0;">
            <img src="./static/images/pedestrian.gif" loading="lazy" onerror="this.onerror=null" alt="Pedestrian prediction example" class="image" style="max-width: 100%; margin: 0 auto;">
            <p class="is-size-6" style="margin-top: 0.5rem;">Pedestrian agent</p>
          </div>
        </div>
      </div>
    </div>


<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Efficient and accurate motion prediction is crucial for ensuring safety and informed decision-making in autonomous driving, particularly under dynamic real-world conditions that necessitate multi-modal forecasts. We introduce TrajFlow, a novel flow matching-based motion prediction framework that addresses the scalability and efficiency challenges of existing generative trajectory prediction methods. Unlike conventional generative approaches that employ i.i.d. sampling and require multiple inference passes to capture diverse outcomes, TrajFlow predicts multiple plausible future trajectories in a single pass, significantly reducing computational overhead while maintaining coherence across predictions. Moreover, we propose a ranking loss based on the Plackett- Luce distribution to improve uncertainty estimation of predicted trajectories. Additionally, we design a self-conditioning training technique that reuses the model's own predictions to construct noisy inputs during a second forward pass, thereby improving generalization and accelerating inference. Extensive experiments on the large-scale Waymo Open Motion Dataset (WOMD) demonstrate that TrajFlow achieves state-of-the- art performance across various key metrics, underscoring its effectiveness for safety-critical autonomous driving applications. The code and other details are available on the project website <a href="https://traj-flow.github.io/" target="_blank">https://traj-flow.github.io/</a>.
          </p>
        </div>
      </div>
    </div>
    <!--/ Abstract. -->

    <!-- Method. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Method</h2>
        <div class="content has-text-justified">
          <p>
            <img src="./static/images/overview.svg" width="100%" height="600px" frameborder="0"></img>
          </p>
          <p>
            <strong>Overview of motion prediction via flow matching.</strong>
            The input scene, including agent history and a road map, is encoded into context tokens via a transformer. During training, noise sampled i.i.d. from a normal distribution is added to the ground truth (GT) trajectory to create a linear interpolation. The denoiser, conditioned on these tokens, predicts denoised trajectories that align with the GT.
            We use a trajectory regression loss for waypoint prediction, a classification loss for confidence score modeling, and a Plackett-Luce distribution-based ranking loss for uncertainty calibration, in order to encourage realistic and diverse motion predictions.
            During inference, trajectories are sampled from pure noise at flow time t=0 and refined through ODEs, yielding a plausible future motion distribution.
          </p>
        </div>
      </div>
    </div>
    <!--/ Method. -->

    <!-- Paper video. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Video</h2>
        <div class="publication-video">
          <iframe src="./static/videos/TrajFlow-1080-30.mp4"
                  frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
      </div>
    </div>
    <!--/ Paper video. -->

    <!-- Additional Results -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Additional Qualitative Results</h2>
        <button class="button is-dark" onclick="toggleAdditionalResults()">Show Additional Results</button>
      </div>
    </div>

    <div class="container" style="max-width: 1200px;">
      <div id="additional-results" style="display: none; margin-top: 2rem;">
        <!-- Vehicles -->
        <h3 class="title is-4 has-text-centered" style="margin-bottom: 1rem;">Vehicle Predictions</h3>
        <!-- Row 1 -->
        <div class="columns is-centered" style="margin: 0 -0.25rem;">
          <div class="column is-half" style="padding: 0 0.25rem;">
            <div class="content has-text-centered" style="margin: 0;">
              <img src="./static/images/more_results/id_134b5aa792a456ec_TYPE_VEHICLE_03.gif" loading="lazy" onerror="this.onerror=null" alt="Additional vehicle prediction" class="image" style="max-width: 100%; margin: 0 auto;">
              <p class="is-size-6" style="margin-top: 0.5rem;">Vehicle agent</p>
            </div>
          </div>
          <div class="column is-half" style="padding: 0 0.25rem;">
            <div class="content has-text-centered" style="margin: 0;">
              <img src="./static/images/more_results/id_125635eaf838cbf4_TYPE_VEHICLE_03.gif" loading="lazy" onerror="this.onerror=null" alt="Additional vehicle prediction" class="image" style="max-width: 100%; margin: 0 auto;">
              <p class="is-size-6" style="margin-top: 0.5rem;">Vehicle agent</p>
            </div>
          </div>
        </div>

        <!-- Row 2 -->
        <div class="columns is-centered" style="margin: 2rem -0.25rem 0 -0.25rem;">
          <div class="column is-half" style="padding: 0 0.25rem;">
            <div class="content has-text-centered" style="margin: 0;">
              <img src="./static/images/more_results/id_11b1f787fb6fe7f9_TYPE_VEHICLE_01.gif" loading="lazy" onerror="this.onerror=null" alt="Additional vehicle prediction" class="image" style="max-width: 100%; margin: 0 auto;">
              <p class="is-size-6" style="margin-top: 0.5rem;">Vehicle agent</p>
            </div>
          </div>
          <div class="column is-half" style="padding: 0 0.25rem;">
            <div class="content has-text-centered" style="margin: 0;">
              <img src="./static/images/more_results/id_110f84cd12b421a9_TYPE_VEHICLE_04.gif" loading="lazy" onerror="this.onerror=null" alt="Additional vehicle prediction" class="image" style="max-width: 100%; margin: 0 auto;">
              <p class="is-size-6" style="margin-top: 0.5rem;">Vehicle agent</p>
            </div>
          </div>
        </div>

        <!-- Row 3 -->
        <div class="columns is-centered" style="margin: 2rem -0.25rem 0 -0.25rem;">
          <div class="column is-half" style="padding: 0 0.25rem;">
            <div class="content has-text-centered" style="margin: 0;">
              <img src="./static/images/more_results/id_10df9646a81a1087_TYPE_VEHICLE_01.gif" loading="lazy" onerror="this.onerror=null" alt="Additional vehicle prediction" class="image" style="max-width: 100%; margin: 0 auto;">
              <p class="is-size-6" style="margin-top: 0.5rem;">Vehicle agent</p>
            </div>
          </div>
          <div class="column is-half" style="padding: 0 0.25rem;">
            <div class="content has-text-centered" style="margin: 0;">
              <img src="./static/images/more_results/id_10b15ae62cf6a249_TYPE_VEHICLE_01.gif" loading="lazy" onerror="this.onerror=null" alt="Additional vehicle prediction" class="image" style="max-width: 100%; margin: 0 auto;">
              <p class="is-size-6" style="margin-top: 0.5rem;">Vehicle agent</p>
            </div>
          </div>
        </div>

        <!-- Pedestrians -->
        <h3 class="title is-4 has-text-centered" style="margin: 3rem 0 1rem 0;">Pedestrian/Cyclist Predictions</h3>
        <!-- Row 4 -->
        <div class="columns is-centered" style="margin: 0 -0.25rem;">
          <div class="column is-half" style="padding: 0 0.25rem;">
            <div class="content has-text-centered" style="margin: 0;">
              <img src="./static/images/more_results/id_130e2b5cc3991379_TYPE_PEDESTRIAN_01.gif" loading="lazy" onerror="this.onerror=null" alt="Additional pedestrian prediction" class="image" style="max-width: 100%; margin: 0 auto;">
              <p class="is-size-6" style="margin-top: 0.5rem;">Pedestrian agent</p>
            </div>
          </div>
          <div class="column is-half" style="padding: 0 0.25rem;">
            <div class="content has-text-centered" style="margin: 0;">
              <img src="./static/images/more_results/id_12d5ce1b476aa6d4_TYPE_PEDESTRIAN_01.gif" loading="lazy" onerror="this.onerror=null" alt="Additional pedestrian prediction" class="image" style="max-width: 100%; margin: 0 auto;">
              <p class="is-size-6" style="margin-top: 0.5rem;">Pedestrian agent</p>
            </div>
          </div>
        </div>

        <!-- Row 5 -->
        <div class="columns is-centered" style="margin: 2rem -0.25rem 0 -0.25rem;">
          <div class="column is-half" style="padding: 0 0.25rem;">
            <div class="content has-text-centered" style="margin: 0;">
              <img src="./static/images/more_results/id_10c3b27f9593de61_TYPE_PEDESTRIAN_01.gif" loading="lazy" onerror="this.onerror=null" alt="Additional pedestrian prediction" class="image" style="max-width: 100%; margin: 0 auto;">
              <p class="is-size-6" style="margin-top: 0.5rem;">Pedestrian agent</p>
            </div>
          </div>
          <div class="column is-half" style="padding: 0 0.25rem;">
            <div class="content has-text-centered" style="margin: 0;">
              <img src="./static/images/more_results/id_10040e572b831a04_TYPE_CYCLIST_01.gif" loading="lazy" onerror="this.onerror=null" alt="Additional cyclist prediction" class="image" style="max-width: 100%; margin: 0 auto;">
              <p class="is-size-6" style="margin-top: 0.5rem;">Cyclist agent</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!--/ Additional Results -->
  </div>
</section>

<script>
function toggleAdditionalResults() {
  const resultsDiv = document.getElementById('additional-results');
  const button = event.target;
  if (resultsDiv.style.display === 'none') {
    resultsDiv.style.display = 'block';
    button.textContent = 'Hide Additional Results';
  } else {
    resultsDiv.style.display = 'none';
    button.textContent = 'Show Additional Results';
  }
}
</script>

<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{yan2025trajflow,
      title={TrajFlow: Multi-modal Motion Prediction via Flow Matching},
      author={Yan, Qi and Zhang, Brian and Zhang, Yutong and Yang, Daniel and White, Joshua and Chen, Di and Liu, Jiachao and Liu, Langechuan and Zhuang, Binnan and Shi, Shaoshuai and others},
      journal={arXiv preprint arXiv:2506.08541},
      year={2025}
    }</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
          <p>
            This page was built using this <a
              href="https://github.com/nerfies/nerfies.github.io">template</a>. You are free to use it for your own
            purposes; we just ask that you link back to this page in the footer.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
